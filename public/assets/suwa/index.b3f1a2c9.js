var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,i=(e,a)=>{for(var t in a||(a={}))s.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&n(e,t,a[t]);return e},o=(e,l)=>a(e,t(l));import{c as m,a as c,o as d}from"./object.48a48dc9.js";import{as as p,n as u,i as f,at as h,K as y,u as E,R as g,ah as w,au as x,M as v,av as b,O as N,I as j,E as z,b as k,A as S,a1 as O,e as P,h as C,a as M,a8 as T}from"./vendor.85072618.js";import{s as q,h as I,M as F,g as _}from"./index.013a26ef.js";import{S as L}from"./index.35770a2c.js";import{f as R,g as V}from"./firebase.98448b6a.js";import{m as W}from"./motion.6226a837.js";var A=p(u.exports.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})),G=p(u.exports.createElement("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}));const U=f((e=>({rightSection:{background:`linear-gradient(to right, ${e.palette.primary.dark} 0%, ${h(e.palette.primary.dark,.5)} 100%)`,color:e.palette.primary.contrastText}}))),$=m().shape({email:c().email("请输入正确的邮箱地址").required("请输入邮箱地址"),passwd:c().required("请输入密码").min(6,"密码太短 - 最少6位")}),B={email:"",passwd:""};function D(){const e=U(),{control:a,formState:t,handleSubmit:l}=y({mode:"onChange",defaultValues:B,resolver:d($)}),{isValid:s,dirtyFields:r,errors:n}=t,m=E((()=>({bg:"",puzz:"",isloading:!0,token:"",passwordShown:!1,set(e){m.bg=e.bg,m.puzz=e.puzz,m.token=e.token,m.isloading=!1},load(){m.isloading=!0,M.get("/api_mweb/captcha").then((e=>{m.set(e)}))},toggerPassword(){m.passwordShown=!m.passwordShown}})));let c="",p="";const f=(e,a,t,l)=>{M.post("/api_mweb/captcha/check",{email:c,passwd:p,token:m.token,n:e}).then((e=>{e?a&&a((()=>{M.post("/api_mweb/login",{email:c,passwd:p,token:e.token}).then((e=>{e?(q.modal.close(),I.push("/home")):q.modal.alert({message:(null==e?void 0:e.message)||"未知错误"})})).catch((e=>{q.modal.alert({message:e.message||"未知错误"})}))})):t&&t((()=>{setTimeout((()=>{m.load()}),500)}))})).catch((()=>{t?t((()=>{setTimeout((()=>{m.load()}),500)})):l&&l()}))};const h=e=>{const a=e.providerId,t=e.accessToken,l=e.secret,s=T.load("code");M.post("/api_mweb/oauth",{provider:a,token:t,secret:l,code:s}).then((e=>{e?(q.modal.cancel(),_(),I.push("/home")):q.modal.alert({message:"快捷登录失败"})})).catch((e=>{q.modal.alert({message:(null==e?void 0:e.message)||"快捷登录失败"})}))};return u.exports.useEffect((()=>{q.user.authed&&I.push("/home")}),[]),g.createElement("div",{className:"flex flex-col flex-auto flex-shrink-0 justify-center items-center p-16 md:p-24"},g.createElement(W.div,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},className:"flex overflow-hidden w-full max-w-400 md:max-w-3xl rounded-20 shadow-2xl"},g.createElement(w,{className:" flex flex-col justify-center items-center w-full max-w-sm shadow-none",square:!0},g.createElement(x,{className:"flex flex-col justify-center items-center py-80 w-full max-w-320"},g.createElement(W.div,{initial:{opacity:0},animate:{opacity:1,transition:{delay:.2}}},g.createElement("div",{className:"flex items-center mb-48"},g.createElement("a",{href:"/"},g.createElement("img",{className:"w-160",src:"/images/logo-dark2x.png",alt:"logo"})))),g.createElement("form",{name:"loginForm",noValidate:!0,className:"flex flex-col justify-center w-full",onSubmit:l((function(e){c=e.email,p=e.passwd,m.load(),q.modal.open({hideOk:!0,hideCancel:!0,autoClose:!0,element:g.createElement(N,null,(()=>g.createElement(L,{displayType:"static",puzzleUrl:m.puzz,bgUrl:m.bg,onRequest:f,onReset:()=>m.load(),tipsStyle:{fontSize:"14px"},reset:"manual",isLoading:m.isloading,resetButton:"inline",imagePosition:"top"})))})}))},g.createElement(v,{name:"email",control:a,render:({field:e})=>{var a;return g.createElement(b,o(i({},e),{className:"mb-16",label:"邮箱",autoFocus:!0,type:"email",error:!!n.email,helperText:null==(a=null==n?void 0:n.email)?void 0:a.message,variant:"outlined",required:!0,fullWidth:!0}))}}),g.createElement(v,{name:"passwd",control:a,render:({field:e})=>g.createElement(N,null,(()=>{var a;return g.createElement(b,o(i({},e),{className:"mb-16",label:"密码",type:m.passwordShown?"text":"password",error:!!n.passwd,helperText:null==(a=null==n?void 0:n.passwd)?void 0:a.message,variant:"outlined",required:!0,fullWidth:!0,InputProps:{endAdornment:g.createElement(j,{"aria-label":"toggle password visibility",onClick:m.toggerPassword,edge:"end"},m.passwordShown?g.createElement(A,null):g.createElement(G,null))}}))}))}),g.createElement("div",{className:"flex flex-col sm:flex-row justify-center sm:justify-between items-center"},g.createElement("a",{href:"/auth/reset"},"忘记密码？")),g.createElement(z,{variant:"contained",color:"primary",className:"mx-auto mt-16 w-full","aria-label":"LOG IN",disabled:k.isEmpty(r)||!s,type:"submit"},"登录")),g.createElement("div",{className:"flex justify-center items-center my-24"},g.createElement(S,{className:"w-32"}),g.createElement("span",{className:"mx-8 font-semibold"},"快捷登录"),g.createElement(S,{className:"w-32"})),g.createElement(N,null,(()=>g.createElement(g.Fragment,null,g.createElement(z,{variant:"outlined",color:"primary",size:"small",className:"mb-8 w-192",onClick:()=>{return e=V,q.modal.loading(),void R().signInWithPopup(e).then((e=>{h(e.credential)})).catch((e=>{if("auth/account-exists-with-different-credential"==e.code)return h(e.credential);q.modal.alert({message:"快捷登录失败"})}));var e}},g.createElement(F,{color:"inherit",name:"google",fontSize:"small",className:"mr-10"}),"Google 帐号"))))),g.createElement("div",{className:"flex flex-col justify-center items-center"},g.createElement(O,{className:"font-normal",to:"/register"},"注册帐号")),g.createElement("div",{className:"flex flex-row justify-between p-32 w-full"},g.createElement("div",{className:"flex"},g.createElement("div",{className:"px-16"},g.createElement("a",{href:"/tos"},"服务条款")),g.createElement("div",{className:"px-16"},g.createElement("a",{href:"/privacy"},"隐私权"))),g.createElement("div",{className:"px-16"},g.createElement("a",{href:"https://suwav2ray.com",rel:"noreferrer"},"帮助中心")))),g.createElement("div",{className:P(e.rightSection,"hidden md:flex flex-1 justify-center items-center p-64")},g.createElement("div",{className:"max-w-320"},g.createElement(W.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0,transition:{delay:.3}}},g.createElement(C,{color:"inherit",className:"text-32 sm:text-44 font-semibold leading-tight"},"欢迎您 来到 ",g.createElement("br",null)," 速蛙云!")),g.createElement(W.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0,transition:{delay:.8}}},g.createElement(C,{variant:"subtitle1",color:"inherit",className:"mt-32 font-medium"},"独家智能负载技术，高速传输稳定不掉")),g.createElement(W.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0,transition:{delay:1.2}}},g.createElement(C,{variant:"subtitle1",color:"inherit",className:"mt-16 font-medium"},"自有协议负载过墙，稳定快速共同见证")),g.createElement(W.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0,transition:{delay:1.6}}},g.createElement(C,{variant:"subtitle1",color:"inherit",className:"mt-16 font-medium"},"速蛙福利社，前无古人后无来者"))))))}export{D as default};
